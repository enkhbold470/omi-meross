{
	"info": {
		"_postman_id": "omi-meross-api-collection",
		"name": "OMI Meross API",
		"description": "Complete API collection for OMI Meross Device Controller",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login Page (HTML)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/login?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["login"],
							"query": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID for webhook identification"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Login Form Submission",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID (from OMI device)"
								},
								{
									"key": "email",
									"value": "your-meross-email@example.com",
									"description": "Meross account email"
								},
								{
									"key": "password",
									"value": "your-meross-password",
									"description": "Meross account password"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/login",
							"host": ["{{base_url}}"],
							"path": ["login"]
						}
					},
					"response": []
				},
				{
					"name": "API Login (JSON)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"your-meross-email@example.com\",\n    \"password\": \"your-meross-password\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/login?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["api", "login"],
							"query": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "Optional: User ID for webhook identification"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Store Credentials for Webhook",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID (required)"
								},
								{
									"key": "email",
									"value": "your-meross-email@example.com",
									"description": "Meross account email"
								},
								{
									"key": "password",
									"value": "your-meross-password",
									"description": "Meross account password"
								},
								{
									"key": "device_uuid",
									"value": "",
									"description": "Optional: Default device UUID"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/webhook/store-credentials",
							"host": ["{{base_url}}"],
							"path": ["webhook", "store-credentials"]
						}
					},
					"response": []
				},
				{
					"name": "Check Webhook Setup Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/webhook/setup-status?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["webhook", "setup-status"],
							"query": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID to check"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Devices",
			"item": [
				{
					"name": "Devices Page (HTML)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/devices",
							"host": ["{{base_url}}"],
							"path": ["devices"]
						}
					},
					"response": []
				},
				{
					"name": "List All Devices (API)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/devices/list",
							"host": ["{{base_url}}"],
							"path": ["devices", "list"]
						}
					},
					"response": []
				},
				{
					"name": "Turn On Device by UUID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/devices/{{device_uuid}}/on",
							"host": ["{{base_url}}"],
							"path": ["devices", "{{device_uuid}}", "on"],
							"variable": [
								{
									"key": "device_uuid",
									"value": "your-device-uuid-here"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Turn Off Device by UUID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/devices/{{device_uuid}}/off",
							"host": ["{{base_url}}"],
							"path": ["devices", "{{device_uuid}}", "off"],
							"variable": [
								{
									"key": "device_uuid",
									"value": "your-device-uuid-here"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Turn On (Default Device)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/on",
							"host": ["{{base_url}}"],
							"path": ["on"]
						}
					},
					"response": []
				},
				{
					"name": "Turn Off (Default Device)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/off",
							"host": ["{{base_url}}"],
							"path": ["off"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Webhooks",
			"item": [
				{
					"name": "OMI Webhook (Full Example)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"session_id\": \"RYEXvYutQeb3OwmmEsYDgiafmd02\",\n    \"uid\": \"RYEXvYutQeb3OwmmEsYDgiafmd02\",\n    \"segments\": [\n        {\n            \"id\": \"seg_001\",\n            \"text\": \"turn on the living room light\",\n            \"speaker\": \"user\",\n            \"speaker_id\": 0,\n            \"is_user\": true,\n            \"person_id\": null,\n            \"start\": 0.0,\n            \"end\": 2.5,\n            \"translations\": [],\n            \"speech_profile_processed\": false\n        }\n    ],\n    \"meross_email\": \"your-meross-email@example.com\",\n    \"meross_password\": \"your-meross-password\",\n    \"meross_device_uuid\": null\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/webhook?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["webhook"],
							"query": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID (can also be in request body)"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "OMI Webhook (Minimal - Credentials from Redis)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"session_id\": \"{{uid}}\",\n    \"uid\": \"{{uid}}\",\n    \"segments\": [\n        {\n            \"id\": \"seg_001\",\n            \"text\": \"turn on the bedroom light\",\n            \"speaker\": \"user\",\n            \"speaker_id\": 0,\n            \"is_user\": true,\n            \"person_id\": null,\n            \"start\": 0.0,\n            \"end\": 2.5,\n            \"translations\": [],\n            \"speech_profile_processed\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/webhook?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["webhook"],
							"query": [
								{
									"key": "uid",
									"value": "{{uid}}",
									"description": "User ID - credentials will be retrieved from Redis using this uid"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "OMI Webhook (List Devices)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"session_id\": \"{{uid}}\",\n    \"uid\": \"{{uid}}\",\n    \"segments\": [\n        {\n            \"id\": \"seg_001\",\n            \"text\": \"what devices do I have\",\n            \"speaker\": \"user\",\n            \"speaker_id\": 0,\n            \"is_user\": true,\n            \"person_id\": null,\n            \"start\": 0.0,\n            \"end\": 2.5,\n            \"translations\": [],\n            \"speech_profile_processed\": false\n        }\n    ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/webhook?uid={{uid}}",
							"host": ["{{base_url}}"],
							"path": ["webhook"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Voice Commands",
			"item": [
				{
					"name": "Voice Command (Multipart File)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-Audio-Filename",
								"value": "voice-command.wav",
								"description": "Optional: Audio filename"
							},
							{
								"key": "X-Audio-Sample-Rate",
								"value": "16000",
								"description": "Optional: Audio sample rate"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "audio",
									"type": "file",
									"src": [],
									"description": "Audio file (WAV format)"
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/voice",
							"host": ["{{base_url}}"],
							"path": ["voice"]
						}
					},
					"response": []
				},
				{
					"name": "Voice Command (Raw Body)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-Audio-Filename",
								"value": "voice-command.wav",
								"description": "Audio filename"
							},
							{
								"key": "X-Audio-Sample-Rate",
								"value": "16000",
								"description": "Audio sample rate (default: 16000)"
							},
							{
								"key": "Content-Type",
								"value": "application/octet-stream"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "<binary audio data>",
							"options": {
								"raw": {
									"language": "plaintext"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/voice",
							"host": ["{{base_url}}"],
							"path": ["voice"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Status & Health",
			"item": [
				{
					"name": "Home (Redirect)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/",
							"host": ["{{base_url}}"],
							"path": [""]
						}
					},
					"response": []
				},
				{
					"name": "Service Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/status",
							"host": ["{{base_url}}"],
							"path": ["status"]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000",
			"type": "string"
		},
		{
			"key": "uid",
			"value": "RYEXvYutQeb3OwmmEsYDgiafmd02",
			"type": "string",
			"description": "User ID from OMI device"
		},
		{
			"key": "device_uuid",
			"value": "",
			"type": "string",
			"description": "Meross device UUID"
		}
	]
}

